<!DOCTYPE html>
<html>
  <head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <link href='https://fonts.googleapis.com/css?family=Architects+Daughter' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" type="text/css" href="stylesheets/stylesheet.css" media="screen">
    <link rel="stylesheet" type="text/css" href="stylesheets/github-light.css" media="screen">
    <link rel="stylesheet" type="text/css" href="stylesheets/print.css" media="print">

    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <title>DistProcedure by DistChen</title>
  </head>

  <body>
    <header>
      <div class="inner">
        <h1>DistProcedure</h1>
        <h2>调用存储过程，结果映射，一行代码就足够！</h2>
        <a href="https://github.com/DistChen/distprocedure" class="button"><small>View project on</small> GitHub</a>
      </div>
    </header>

    <div id="content-wrapper">
      <div class="inner clearfix">
        <section id="main-content">
          <hr>

<p><img src="http://3.su.bdimg.com/icon/9898.png" alt="github"><a href="http://weibo.com/ooqingkuangoo/">我的新浪微博</a>
<img src="http://4.su.bdimg.com/icon/7083.png" alt="github"><a href="http://user.qzone.qq.com/365061362/main/">我的QQ空间</a>
<img src="http://3.su.bdimg.com/icon/2602.png?1" alt="github"><a href="http://t.qq.com/cyp365061362/">我的腾讯微博</a></p>

<pre><code>【Instroduce】  
整体功能说明:用于后台调用存储过程的配置式实现，从业务代码中脱离出来。
1、根节点为procedures
2、每一个存储过程对应一个 procedure 节点，procedure节点为procedure子节点
3、procedure 节点共有name、desc、proName、executeClass、excuteMethod、parameters六种子节点，其中desc、executeClass、excuteMethod三种为可选项，其余为必选项 
    name：必选项，功能名，前端调用需要传此值
    desc：必选项，该功能的描述信息
    proName：必选项，存储过程名
    executeClass：可选项，存储过程的执行类，默认的执行类为dist.common.procedure.define.ProcedureExecutor，
              该执行类无法对从数据库中返回的数据做二次业务处理。如有需要对从数据库返回的数据做
              二次处理，请继承该类，然后重写 handerResult 方法，该方法的入参即为从数据库返回
              的数据。
    executeMethod：可选项执行类的默认执行方法，默认方法为 execute，也是为方便二次开发设置
    parmeters：必选项，存储过程参数，参数顺序要保持对应，包含了0个或多个子节点 parameter 
4、paramters 节点包含 parameter 节点，parameter 节点的属性有：
   name：参数名，与存储过程对应，必选
   type：取值 in 或者 out，表明该参数为传入还是传出，必选
   dataType：参数类型，比如varchar代表字符串，date 代表日期类型参数,cursor 代表游标，也可以传具体值，比如varchar=4  date=91
   vo：当 type="out" dataType="cursor" 时，需要设置该值
   format：当dataType="date" 时，可以设置改值，默认为 yyyy/MM/dd ,倘若前端传入值为 2010-08-22，则必须设置format="yyyy-MM-dd"
5、datasource 节点用于配置数据源
</code></pre>

<h3>
<a id="一个示例配置如下" class="anchor" href="#%E4%B8%80%E4%B8%AA%E7%A4%BA%E4%BE%8B%E9%85%8D%E7%BD%AE%E5%A6%82%E4%B8%8B" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>一个示例配置如下:</h3>

<pre><code>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;procedures xmlns="http://www.dist.com.cn"
            xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
            xsi:schemaLocation="http://www.dist.com.cn distprocedure.xsd"&gt;
    &lt;datasource src="config.properties"&gt;
        &lt;driver&gt;${driverClassName}&lt;/driver&gt;
        &lt;url&gt;${url}&lt;/url&gt;
        &lt;username&gt;${username}&lt;/username&gt;
        &lt;password&gt;${password}&lt;/password&gt;
    &lt;/datasource&gt;
    &lt;procedure id="testPro"&gt;
        &lt;proName&gt;pro_test&lt;/proName&gt;
        &lt;parameters&gt;
            &lt;parameter name="p_str" type="in" dataType="varchar"/&gt;
            &lt;parameter name="p_str2" type="in" dataType="varchar"/&gt;
            &lt;parameter name="p_num" type="in" dataType="number" /&gt;
            &lt;parameter name="p_strDate" type="in" dataType="date" format="yyyy-MM-dd" /&gt;
            &lt;parameter name="p_date" type="in" dataType="date" /&gt;
            &lt;parameter name="p_info" type="out" dataType="varchar" /&gt;
            &lt;parameter name="p_cursor" type="out" dataType="cursor" vo="dist.dgp.controller.Person"/&gt;
        &lt;/parameters&gt;
    &lt;/procedure&gt;
&lt;/procedures&gt;
</code></pre>

<h3>
<a id="版本更新说明" class="anchor" href="#%E7%89%88%E6%9C%AC%E6%9B%B4%E6%96%B0%E8%AF%B4%E6%98%8E" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>版本更新说明:</h3>

<pre><code>    -------------------1.0.1-replease--------------------
    1、支持注释节点的解析
    2、支持配置多个配置文件，比如对应的控制器类中的features属性设置如下:
         p:features="features1.xml features2.xml features3.xml"
    3、name、desc、proName、executeClass、excuteMethod、parameters 忽略大小写影响

    -------------------1.0.2-replease--------------------
    1、消除了在配置文件中的空格影响，比如如下的配置:
       &lt;proName&gt;importCatalog&lt;/proName&gt; 与 &lt;proName&gt;  importCatalog    &lt;/proName&gt;
       上述两种配置是等效的。在1.0.2-replease版本之前后者配置方式无效
    2、支持新增 format 属性，自动处理存储过程中日期类型的参数传字符串格式的数据的情况，当前端传一个字符串的日期数据时，设置 format 属性值为前端值格式，默认值为 yyyy/MM/dd
       比如值为“2010-08-22”时，设置format=“yyyy-MM-dd”,而值为“2010/08/22”,可以不用设置 format 属性
       注意:只有 dataType="date" 类型的参数才需要 format 属性
    3、支持新增 desc 节点，desc 节点用来对存储过程进行描述
    4、配置文件路径问题，以前只能加载类路径下的配置文件，现在可以同时加载类路径和文件系统下的配置文件，而且可以以空格和逗号分隔，如下:
       p:features="features1.xml,F:\MyEclipseWorkSpace\SZMDServer\src\features.xml features3.xml"

    -------------------1.1.0-replease--------------------
    1、解除对 spring 的依赖
    2、新增 datasource 节点
    3、新增ProcedureRepository存储过程仓库
    4、新增ProcedureListener配置文件监听器
</code></pre>
        </section>

        <aside id="sidebar">
          <a href="https://github.com/DistChen/distprocedure/zipball/master" class="button">
            <small>Download</small>
            .zip file
          </a>
          <a href="https://github.com/DistChen/distprocedure/tarball/master" class="button">
            <small>Download</small>
            .tar.gz file
          </a>

          <p class="repo-owner"><a href="https://github.com/DistChen/distprocedure"></a> is maintained by <a href="https://github.com/DistChen">DistChen</a>.</p>

          <p>This page was generated by <a href="https://pages.github.com">GitHub Pages</a> using the Architect theme by <a href="https://twitter.com/jasonlong">Jason Long</a>.</p>
        </aside>
      </div>
    </div>

  
  </body>
</html>
